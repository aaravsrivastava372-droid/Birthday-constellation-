<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Star Map</title>

<style>
body{
    margin:0;
    padding:0;
    background:black;
    overflow:hidden;
    font-family:'Segoe UI',sans-serif;
}

canvas{
    position:absolute;
    top:0;
    left:0;
}

.centerText{
    position:absolute;
    width:100%;
    text-align:center;
    top:50%;
    transform:translateY(-50%);
    font-size:18px;
    color:white;
    opacity:.6;
    animation:fade 2s infinite alternate;
}

@keyframes fade{
    from{opacity:.3}
    to{opacity:1}
}
</style>
</head>
<body>

<div class="centerText">✨ look at the stars ✨</div>

<audio autoplay loop>
<source src="music.mp3" type="audio/mpeg">
</audio>

<canvas id="sky"></canvas>

<script>
const canvas = document.getElementById("sky");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = [];
let forming = false;

// create background stars
for(let i=0;i<160;i++){
    stars.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        size:Math.random()*1.8,
        alpha:1,
        targetX:null,
        targetY:null
    });
}

const text = "HAPPY BIRTHDAY\nAKSHARA";

// responsive font size
let fontSize;
if(window.innerWidth < 500){
    fontSize = 32; // phone
}else if(window.innerWidth < 900){
    fontSize = 50; // tablet
}else{
    fontSize = 70; // pc
}

function getTextPixels(){
    const off = document.createElement("canvas");
    const offCtx = off.getContext("2d");

    off.width = canvas.width;
    off.height = canvas.height;

    offCtx.fillStyle="white";
    offCtx.textAlign="center";
    offCtx.textBaseline="middle";
    offCtx.font="bold "+fontSize+"px Arial";

    let lines = text.split("\n");
    let lineHeight = fontSize + 10;
    let startY = canvas.height/2 - (lines.length/2 * lineHeight) + lineHeight/2;

    for(let i=0;i<lines.length;i++){
        offCtx.fillText(lines[i], canvas.width/2, startY + i*lineHeight);
    }

    const data = offCtx.getImageData(0,0,off.width,off.height).data;
    let pixels=[];

    for(let y=0;y<off.height;y+=6){
        for(let x=0;x<off.width;x+=6){
            let index=(y*off.width+x)*4;
            if(data[index+3]>150){
                pixels.push({x,y});
            }
        }
    }
    return pixels;
}

function formText(){
    const pixels = getTextPixels();

    for(let i=0;i<pixels.length;i++){
        if(stars[i]){
            stars[i].targetX = pixels[i].x;
            stars[i].targetY = pixels[i].y;
        }else{
            stars.push({
                x:Math.random()*canvas.width,
                y:Math.random()*canvas.height,
                size:2,
                alpha:0,
                targetX:pixels[i].x,
                targetY:pixels[i].y
            });
        }
    }

    for(let i=pixels.length;i<stars.length;i++){
        stars[i].fade=true;
    }

    forming=true;
}

setTimeout(formText,4000);

function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    stars.forEach(star=>{
        if(forming && star.targetX!=null){
            star.x += (star.targetX-star.x)*0.05;
            star.y += (star.targetY-star.y)*0.05;
            star.alpha = Math.min(1, star.alpha+0.02);
        }

        if(star.fade){
            star.alpha -=0.02;
            if(star.alpha<0) star.alpha=0;
        }

        ctx.globalAlpha = star.alpha;
        ctx.beginPath();
        ctx.arc(star.x,star.y,star.size,0,Math.PI*2);
        ctx.fillStyle="white";
        ctx.fill();
    });

    requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
